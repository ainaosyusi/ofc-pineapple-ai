# OFC Pineapple AI - ロードマップと期待効果

## 現在の状況 (2026-01-18)

### Phase 7 完了モデルの性能 (公式記録)

| 指標 | 値 | 人間レベル換算 |
|:---|---:|:---|
| 総学習ステップ | 20,000,000 | - |
| ファウル率 | **25.8%** | 中級〜上級者 (25-35%) |
| Mean Royalty | **7.56** | 上級者 (5-8点) |
| FL Entry Rate | 1.1% | 基礎 |
| 勝率 (vs Random) | 65-68% | - |
| 平均スコア | +6.5 | - |

**注**: Mean Royaltyは学習ログの統計。ローカル評価(100ゲーム)では約1.0だが、
これはランダム相手との短期評価のため変動が大きい。

### 視覚的なプレイ例

```
  [AI] Score: +32 | Royalty: 10
  Top:    7♥ K♥ 2♣
  Middle: 7♠ 3♥ A♥ 7♦ K♣
  Bottom: 4♠ A♠ A♦ A♣ JK      (Trips Aces + Joker)

  [Random 1] Score: -22 | FOUL!
  [Random 2] Score: -10 | Royalty: 0
```

**観察**: AIはジョーカーを効果的に使い、ボトムでトリップスAを構築。ファウルを避けながら確実にポイントを稼いでいる。

---

## Phase 8 Self-Playの期待効果

### 1. 戦略的適応力の向上

**現状の問題点**:
- ランダム相手のみで学習 → 「弱い相手に勝てる」戦略に偏っている可能性
- 対人戦で必要な「駆け引き」が未学習

**Phase 8で期待される改善**:
```
過去の自分 vs 現在の自分
     ↓
「自分を倒す」戦略の学習
     ↓
より堅牢で汎用的なプレイスタイル
```

### 2. 相手への対応力

| 観点 | Phase 7 (vs Random) | Phase 8 (Self-Play) |
|:---|:---|:---|
| 相手のブロック認識 | 学習なし | 学習される |
| リスク管理 | 単純 | 状況適応 |
| 役完成の競争 | なし | あり |
| FL阻止戦略 | なし | あり |

### 3. 予想される数値変化

| 指標 | Phase 7 | Phase 8 予測 | 理由 |
|:---|---:|---:|:---|
| ファウル率 | 25% | 20-25% | 微減〜維持 |
| Mean Royalty | 1.0 | 1.5-3.0 | 攻防のバランス改善 |
| FL Rate | 2% | 3-5% | 積極的FL狙い |
| vs Random勝率 | 65% | 70-80% | 戦略の洗練 |

---

## 将来のフェーズ計画

### Phase 9: MCTS強化 (検討中)

**目的**: 終盤の最適プレイ精度向上

```
NN Policy + MCTS探索
     ↓
終盤5手をMCTSで最適化
     ↓
クリティカルな判断の精度UP
```

**期待効果**:
- ファウル率さらに低下 (→15-20%)
- FL到達率向上 (→5-10%)

### Phase 10: 人間対戦評価

**目的**: 実際の人間プレイヤーとの対戦

**評価方法**:
1. OFCアプリとの対戦
2. 人間プレイヤーとのオンライン対戦
3. プロプレイヤーとのレビュー

**目標**:
- 中〜上級者に対して勝率50%以上

### Phase 11: FantasyLand特化学習 (オプション)

**目的**: FL突入・維持の最適化

```
FL用の専用Solver
     ↓
14枚最適配置の学習
     ↓
FL連続（FL-on-FL）の達成
```

---

## 技術的改善余地

### 1. 観測空間の改善

現在の観測 (約870次元):
- 自分のボード (162)
- 手札 (270)
- 相手ボード×2 (324)
- その他 (約110)

**改善案**:
- 相手の捨て札情報の追加
- 残りデッキの確率分布
- 相手の役完成予測

### 2. 報酬設計の最適化

現在の報酬:
- ゲーム終了時のスコア
- FL突入ボーナス (+15)

**改善案**:
- 中間報酬（役が完成に近づくごとに）
- リスク調整報酬（FL狙いリスク）
- 相対的報酬（相手との差分）

### 3. ネットワーク構造

現在: MLP (64-64)

**改善案**:
- Attention機構（カード間の関係性）
- 残差接続
- より大きなネットワーク

---

## 評価ベンチマーク

### 達成基準表

| レベル | ファウル率 | Royalty | FL Rate | 目標 |
|:---|---:|---:|---:|:---|
| Bronze | < 40% | > 0.5 | > 0% | Phase 1-3 |
| Silver | < 30% | > 1.0 | > 1% | Phase 4-5 |
| Gold | < 25% | > 2.0 | > 3% | Phase 7 |
| Platinum | < 20% | > 3.0 | > 5% | Phase 8 目標 |
| Diamond | < 15% | > 5.0 | > 10% | 最終目標 |

### 現在の位置

```
[Bronze]──[Silver]──[Gold]──[Platinum]──[Diamond]
                      ↑
                   現在地
                 (Phase 7)
```

---

## 開発リソース見積もり

### Phase 8 学習

| 項目 | 値 |
|:---|---:|
| 目標ステップ | 20M |
| 推定時間 | 7-8時間 |
| インスタンス | n2-standard-4 |
| 推定コスト | ~$1.5 |

### 全体タイムライン

| Phase | 期間 | ステータス |
|:---|:---|:---|
| Phase 1-7 | 完了 | Done |
| Phase 8 | 2026/01/18〜 | **進行中** (GCP n2-standard-4) |
| Phase 9 | TBD | 計画中 |
| Phase 10 | TBD | 計画中 |

### Phase 8 進捗監視

```bash
# ログ確認
ssh naoai@35.243.93.32 "tail -50 ~/ofc-training/training.log"

# Discord通知で確認される項目
- Foul Rate: ファウル率
- Mean Score: 平均スコア（進捗の主要指標）
- Mean Royalty: 平均ロイヤリティ
- Win Rate: 勝率
```

---

## まとめ

### Phase 8の意義

1. **Self-Playによる戦略深化**: ランダム相手から自己対戦へ。より高度な戦略の獲得。
2. **対人戦への準備**: 実際の人間相手に通用する堅牢なプレイスタイルの構築。
3. **継続的改善の基盤**: Self-Playループにより、継続的な強化が可能。

### 長期ビジョン

```
現在                  中期目標              最終目標
上級者レベル    →    プロレベル      →    超人レベル
(Foul 25%)          (Foul 15-20%)        (Foul <10%)
(Royalty 1)         (Royalty 3-5)        (Royalty 7+)
```

---

## 更新履歴

| 日付 | 内容 |
|:---|:---|
| 2026-01-18 | Phase 7公式結果を反映（Foul 25.8%, Royalty 7.56）。Phase 8再開。 |
| 2026-01-18 | 初版作成。Phase 8開始に伴いロードマップを整備。 |
